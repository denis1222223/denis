<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html"; charset="utf-8">
    <title>Ajax request viewer</title>

    <link rel="stylesheet" href="../lib/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../lib/jquery-ui-1.12.1/jquery-ui.min.css">
    <link rel="stylesheet" href="css/ajaxRequestViewer.css">

    <script type="text/javascript" src="../lib/jquery-ui-1.12.1/external/jquery/jquery.js"></script>
    <script type="text/javascript" src="../lib/jquery-ui-1.12.1/jquery-ui.min.js"></script>
    <script type="text/javascript" src="src/ajaxRequestViewer.js"></script>
    <script type="text/javascript" src="src/ajaxLogger.js"></script>
    <script type="text/javascript" src="src/ajaxRequestLogger.js"></script>

    <script type='text/javascript'>
        $(document).ready(function() {

//            var settings1 = {
//                requestSettings: {
//                    success: function (data) {
//                        console.log("finish");
//                    },
//                    url: '1.exe'
//                },
//                guiSettings: {
//                    output: $("#viewBox1").add("#viewBox2"),
//                    color: "#fff",
//                    backgroundColor: "#648",
//                    width: "120px",
//                    height: "10px"
//                }
//            };
//
//            var settings2 = {
//                requestSettings: {
//                    success: function (data) {
//                        console.log("finish");
//                    },
//                    url: 'ajaxRequestViewer.html'
//                },
//                guiSettings: {
//                    output: $("#viewBox3")
//                }
//            };
//
//            $("#button1").ajaxRequestViewer(settings1);
//            $("#button2").ajaxRequestViewer(settings2);

//            console.log(this);
//            $(this).ajaxLogger();


//            $.fn.ajaxRequestLogger();


          //  requestInterceptor.initialize);
//            var d = new requestInterceptor();
//            console.log(d);
            requestInterceptor.initialize({
                output: $("#output")
            });

            requestInterceptor.start();

//            var d = $.ajaxSettings.xhr().addEventListener('progress', function(evt) {
//                if (evt.lengthComputable) {
//                    var percentComplete = Math.ceil(evt.loaded / evt.total * 100);
////                    output.text(percentComplete + "%");
//                    console.log(percentComplete + "%");
//                    console.log("kek");
//                }
//            }, false);


            var xxxhr = function() {
                var xhr = $.ajaxSettings.xhr();
                xhr.addEventListener('progress', function(evt) {
                    if (evt.lengthComputable) {
                        var percentComplete = Math.ceil(evt.loaded / evt.total * 100);
                        console.log(percentComplete + "%");
                    }
                }, false);
                return xhr;
            };
            $.ajax.xhr = xxxhr;

            $.ajax({
                success: function (data) {
                    console.log("finish");
                },
                url: 'ajaxRequestViewer.html',
//                xhr: xxxhr
            });
//            requestInterceptor.pause();
//            requestInterceptor.stop();
        });
    </script>
</head>
<body>
<textarea id="output"></textarea>
<!--<div class="content">-->
    <!--<div class="buttons">-->
        <!--<a href="#" id="button1" class="buttonSend">Send Request 1</a>-->
        <!--<a href="#" id="button2" class="buttonSend">Send Request 2</a>-->
    <!--</div>-->
    <!--<div id="viewBox1" class="viewBox">block 1</div>-->
    <!--<div id="viewBox2" class="viewBox">block 2</div>-->
    <!--<div id="viewBox3" class="viewBox">block 3</div>-->
<!--</div>-->

</body>
</html>
